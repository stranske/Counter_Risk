version: 1
issue: 88
base: main
branch: codex/issue-88
tasks:
  - id: task-01
    title: Create a macro-enabled Excel workbook file named `Runner.xlsm` with the
      correct OOXML structure and content types
    status: done
    started_at: '2026-02-13T23:15:37Z'
    finished_at: '2026-02-13T23:15:51Z'
    commit: 45f681b37c6ba6a4fac9f53d3533363fce3c9e60
    notes: []
  - id: task-02
    title: Embed a valid VBA project binary at `xl/vbaProject.bin` within the `Runner.xlsm`
      package structure
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-03
    title: Add the `RunnerLaunch.bas` module content to the embedded VBA project with
      all required public subroutines
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-04
    title: Verify the embedded VBA project by unzipping `Runner.xlsm` and confirming
      `xl/vbaProject.bin` exists and is non-empty
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-05
    title: 'Update `Runner.xlsm` form controls to assign macros to buttons: `Run All`
      -> `RunAll_Click`, `Run Ex Trend` -> `RunExTrend_Click`, `Run Trend` -> `RunTrend_Click`,
      `Open Output Folder` -> `OpenOutputFolder_Click`'
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-06
    title: Implement `Public Sub RunAll_Click()` entrypoint that reads selected date
      and calls the shared command builder with `All` mode
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-07
    title: Implement `Public Sub RunExTrend_Click()` entrypoint that reads selected
      date and calls the shared command builder with `ExTrend` mode
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-08
    title: Implement `Public Sub RunTrend_Click()` entrypoint that reads selected
      date and calls the shared command builder with `Trend` mode
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-09
    title: Implement `Public Sub OpenOutputFolder_Click()` entrypoint that resolves
      the output directory and opens it with platform-appropriate commands
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-10
    title: Implement a shared VBA command-builder function `BuildCommand(runMode As
      String, selectedDate As String, outputDir As String) As String` and update the
      three run entrypoints to call it
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-11
    title: Implement command execution in `RunnerLaunch.bas` using `Shell` or `WScript.Shell.Run`
      to launch the constructed command string
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-12
    title: Add structured error handling with `On Error` statements to catch launch
      failures without showing runtime error dialogs
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-13
    title: Implement a launch status return mechanism that provides success or failure
      indication with error codes or messages
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-14
    title: Update the execution logic to capture and return process launch failures
      as structured status objects
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-15
    title: Implement a single VBA output-directory resolver `ResolveOutputDir(repoRoot,
      selectedDate)` that standardizes output to `repo-root/runs/<date>` and update
      both executable-argument building and `OpenOutputFolder_Click` to use the same
      resolved path
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-16
    title: Implement `OpenOutputFolder_Click` to check directory existence with `Dir()`
      or `FileSystemObject` before opening, and if the directory does not exist, write
      an error message containing `Directory not found` and the resolved path string
      to the UI result area
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-17
    title: Identify or define named ranges or cell references for the UI status area
      and last-run result area in `Runner.xlsm`
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-18
    title: Implement pre-launch status updates that write exactly `Running...` to
      the status area before command execution begins
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-19
    title: Implement post-launch success updates that write `Success` to the last-run
      result area when launch completes without errors
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-20
    title: Implement post-launch error updates that write `Error` with code or message
      to the last-run result area when launch fails
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-21
    title: Create unit tests that validate command construction for the `All` run
      mode with at least two distinct date selections
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-22
    title: Create unit tests that validate command construction for the `ExTrend`
      run mode with at least two distinct date selections
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-23
    title: Create unit tests that validate command construction for the `Trend` run
      mode with at least two distinct date selections
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-24
    title: Create unit tests that validate output-path standardization including path
      separator normalization and exact directory strings
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-25
    title: Implement test fixtures that stub or mock `Shell` and `WScript.Shell` calls
      to avoid requiring real executable binaries
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-26
    title: Implement test fixtures that stub or mock filesystem and explorer calls
      to avoid requiring real directories
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-27
    title: Write documentation in `README.md` or `TESTING.md` that specifies the single
      command to run all unit tests locally (e.g., `pytest -q`)
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-28
    title: Verify all newly added tests pass in CI pipeline (agent cannot retry CI
      pipelines; human must monitor CI results and address failures)
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-29
    title: The committed `Runner.xlsm` file has a `.xlsm` extension, contains `xl/vbaProject.bin`
      that is at least 1KB in size when unzipped, and can be opened in Excel without
      macro security warnings (when macros are enabled)
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-30
    title: The VBA project in `Runner.xlsm` contains a standard module named `RunnerLaunch`
      (or `RunnerLaunch.bas` content imported) and it defines `Public Sub RunAll_Click()`,
      `Public Sub RunExTrend_Click()`, `Public Sub RunTrend_Click()`, and `Public
      Sub OpenOutputFolder_Click()` as public entrypoints
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-31
    title: 'Each of the four UI controls/buttons in `Runner.xlsm` is assigned to the
      correct macro name: `Run All` -> `RunAll_Click`, `Run Ex Trend` -> `RunExTrend_Click`,
      `Run Trend` -> `RunTrend_Click`, and `Open Output Folder` -> `OpenOutputFolder_Click`'
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-32
    title: 'VBA command construction is centralized: there is exactly one shared command-builder
      function (e.g., `Function BuildCommand(runMode As String, selectedDate As String,
      outputDir As String) As String`) invoked by all three run entrypoints (`RunAll_Click`,
      `RunExTrend_Click`, `RunTrend_Click`)'
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-33
    title: '`RunnerLaunch.bas` executes the constructed command via Shell-like invocation
      (e.g., `Shell`, `WScript.Shell.Run`, or `WScript.Shell.Exec`) and returns a
      launch status to callers (success/failure and an error message or code)'
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-34
    title: 'The execution logic is not build-only: it actually invokes the command
      and captures the result'
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-35
    title: When the executable cannot be found or Shell invocation fails, the runner
      writes an error message to the result area that contains the word `Error` and
      at least 10 characters of diagnostic information (e.g., file path or error code),
      and the VBA code includes `On Error Resume Next` or `On Error GoTo` statements
      before Shell calls
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-36
    title: Output directory path construction produces exactly `<repo-root>/runs/<date>`
      where `<repo-root>` is resolved from the workbook location and `<date>` is in
      YYYY-MM-DD format, and unit tests verify this exact path format is used in both
      executable arguments and `OpenOutputFolder_Click`
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-37
    title: '`OpenOutputFolder_Click` checks directory existence with `Dir()` or `FileSystemObject`
      before opening, and if the directory does not exist, writes an error message
      to the result area containing the text `Directory not found` and the resolved
      path string'
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-38
    title: On run start (any of the three run buttons), the UI status area is set
      to exactly `Running...` before attempting to launch the executable
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-39
    title: After the launch attempt completes (success or failure), the UI last-run
      result area is updated with either `Success` or a string containing `Error`
      and an associated code/message (exit code if available or a launch error)
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-40
    title: Automated unit tests exist that validate command construction for all three
      run modes (`All`, `ExTrend`, `Trend`) and at least two distinct date/month selections,
      asserting that the generated command contains the correct run-mode flag(s) and
      the selected date/month value(s) in the expected argument positions/names
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-41
    title: 'Automated unit tests exist that validate output-path standardization,
      including at minimum: (a) correct joining/normalization of path separators,
      and (b) exact output directory string for a fixed repo-root and date input'
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-42
    title: All newly added tests are runnable locally with a single documented command
      (e.g., `pytest -q`) without requiring Excel UI automation or a real executable
      binary present (launch/explorer calls are stubbed/mocked)
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
  - id: task-43
    title: The repository contains documentation (in `README.md` or `TESTING.md`)
      that specifies the exact command to run all unit tests
    status: todo
    started_at: null
    finished_at: null
    commit: ''
    notes: []
